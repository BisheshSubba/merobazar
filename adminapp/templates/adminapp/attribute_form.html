{% extends "adminapp/admin_base.html" %}

{% block extra_css %}
<style>
    .attr-form-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 40px 20px;
    }

    .attr-form-card {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        padding: 30px;
    }

    .attr-form-header {
        border-bottom: 2px solid #eee;
        margin-bottom: 20px;
        padding-bottom: 10px;
    }

    .attr-form-title {
        font-size: 28px;
        font-weight: 600;
        color: #4B4B4B;
    }

    .attr-form-body {
        margin-top: 20px;
    }

    .attr-form-section {
        margin-bottom: 30px;
    }

    .attr-section-title {
        font-size: 20px;
        font-weight: 500;
        margin-bottom: 15px;
        color: #5A5A5A;
    }

    .attr-form-row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }

    .attr-form-group {
        flex: 1;
        min-width: 200px;
        position: relative;
    }

    .attr-form-label {
        display: block;
        margin-bottom: 6px;
        font-weight: 500;
        color: #333;
    }

    .attr-form-input,
    .attr-form-select,
    .attr-form-check-input {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 15px;
    }

    .attr-form-select {
        padding-right: 30px;
    }

    .attr-form-check {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 32px;
    }

    .attr-form-check-label {
        font-weight: 500;
        color: #444;
    }

    .attr-form-btn {
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: background 0.3s ease;
        text-decoration: none;
    }

    .attr-btn-primary {
        background: #007bff;
        color: white;
    }

    .attr-btn-primary:hover {
        background: #0069d9;
    }

    .attr-btn-secondary {
        background: #6c757d;
        color: white;
    }

    .attr-btn-secondary:hover {
        background: #5a6268;
    }

    .attr-invalid-feedback {
        color: red;
        font-size: 13px;
        margin-top: 4px;
    }

    .attr-has-icon {
        position: relative;
    }

    .attr-input-icon {
        position: absolute;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
        color: #999;
    }

    .attr-has-icon input,
    .attr-has-icon select {
        padding-left: 34px;
    }

    .attr-textarea-field textarea {
        resize: vertical;
        min-height: 100px;
    }
</style>
{% endblock %}

{% block content %}
<div class="attr-form-container">
    <div class="attr-form-card">
        <div class="attr-form-header">
            <h3 class="attr-form-title">{{ title }}</h3>
        </div>
        <form method="post" id="attribute-form">
            <div class="attr-form-body">
                {% csrf_token %}

                {% if form.non_field_errors %}
                    <div class="alert alert-danger">
                        {% for error in form.non_field_errors %}
                            {{ error }}
                        {% endfor %}
                    </div>
                {% endif %}

                <div class="attr-form-section">
                    <h5 class="attr-section-title">Attribute Details</h5>
                    <div class="attr-form-row">
                        <div class="attr-form-group attr-has-icon">
                            <label for="{{ form.name.id_for_label }}" class="attr-form-label">Attribute Name</label>
                            <i class="fas fa-tag attr-input-icon"></i>
                            <input type="text" name="{{ form.name.name }}"
                                   class="attr-form-input" id="{{ form.name.id_for_label }}"
                                   value="{{ form.name.value|default_if_none:'' }}">
                            {% if form.name.errors %}
                                <div class="attr-invalid-feedback">
                                    {{ form.name.errors }}
                                </div>
                            {% endif %}
                        </div>

                        <div class="attr-form-group attr-has-icon">
                            <label for="{{ form.data_type.id_for_label }}" class="attr-form-label">Data Type</label>
                            <i class="fas fa-code attr-input-icon"></i>
                            <select name="{{ form.data_type.name }}"
                                    class="attr-form-select" id="{{ form.data_type.id_for_label }}">
                                {% for value, label in form.data_type.field.choices %}
                                    <option value="{{ value }}" {% if form.data_type.value == value %}selected{% endif %}>
                                        {{ label }}
                                    </option>
                                {% endfor %}
                            </select>
                            {% if form.data_type.errors %}
                                <div class="attr-invalid-feedback">
                                    {{ form.data_type.errors }}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="attr-form-row">
                        <div class="attr-form-group">
                            <div class="attr-form-check">
                                <input type="checkbox" name="{{ form.is_required.name }}"
                                       class="attr-form-check-input" id="{{ form.is_required.id_for_label }}"
                                       {% if form.is_required.value %}checked{% endif %}>
                                <label class="attr-form-check-label" for="{{ form.is_required.id_for_label }}">
                                    Required Attribute
                                </label>
                            </div>
                        </div>

                        <div class="attr-form-group attr-textarea-field">
                            <label for="{{ form.options.id_for_label }}" class="attr-form-label">Options (if applicable)</label>
                            <textarea name="{{ form.options.name }}"
                                      class="attr-form-input" id="{{ form.options.id_for_label }}"
                                      rows="4">{{ form.options.value|default_if_none:'' }}</textarea>
                            {% if form.options.errors %}
                                <div class="attr-invalid-feedback">
                                    {{ form.options.errors }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <input type="hidden" name="{{ form.object_id.name }}" value="{{ form.object_id.value|default_if_none:'' }}">
            </div>

            <div class="attr-form-footer">
                <button type="submit" class="attr-form-btn attr-btn-primary">
                    <i class="fas fa-save"></i> Save Attribute
                </button>
                <a href="{% url 'manage_categories' %}" class="attr-form-btn attr-btn-secondary">
                    <i class="fas fa-times"></i> Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        if (typeof $ !== 'undefined' && $.fn.select2) {
            $('.attr-form-select').select2({
                theme: 'bootstrap-5',
                width: '100%'
            });
        }
    });
</script>
{% endblock %}
